"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
async function batchExecute({ onEachBatch, onBeforeBatch, onAfterBatch, onBatchSuccess, onBatchError, batchSize, data, }) {
    const dataSize = data.length;
    let cursor = 0;
    while (cursor < dataSize) {
        const batch = data.slice(cursor, cursor + batchSize);
        const batchIndex = cursor / batchSize;
        cursor += batchSize;
        onBeforeBatch && (await onBeforeBatch(batch, batchIndex));
        try {
            await onEachBatch(batch, batchIndex);
            onBatchSuccess && (await onBatchSuccess(batch, batchIndex));
        }
        catch (error) {
            onBatchError && (await onBatchError(error, batch, batchIndex));
        }
        onAfterBatch && (await onAfterBatch(batch, batchIndex));
    }
}
exports.default = batchExecute;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmF0Y2gtZXhlY3V0ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9iYXRjaC1leGVjdXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQWUsS0FBSyxVQUFVLFlBQVksQ0FBVSxFQUNsRCxXQUFXLEVBQ1gsYUFBYSxFQUNiLFlBQVksRUFDWixjQUFjLEVBQ2QsWUFBWSxFQUNaLFNBQVMsRUFDVCxJQUFJLEdBU0w7SUFDQyxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQzdCLElBQUksTUFBTSxHQUFHLENBQUMsQ0FBQztJQUdmLE9BQU8sTUFBTSxHQUFHLFFBQVEsRUFBRTtRQUN4QixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxNQUFNLEdBQUcsU0FBUyxDQUFDLENBQUM7UUFDckQsTUFBTSxVQUFVLEdBQUcsTUFBTSxHQUFHLFNBQVMsQ0FBQztRQUN0QyxNQUFNLElBQUksU0FBUyxDQUFDO1FBRXBCLGFBQWEsSUFBSSxDQUFDLE1BQU0sYUFBYSxDQUFDLEtBQUssRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDO1FBQzFELElBQUk7WUFDRixNQUFNLFdBQVcsQ0FBQyxLQUFLLEVBQUUsVUFBVSxDQUFDLENBQUM7WUFDckMsY0FBYyxJQUFJLENBQUMsTUFBTSxjQUFjLENBQUMsS0FBSyxFQUFFLFVBQVUsQ0FBQyxDQUFDLENBQUM7U0FDN0Q7UUFBQyxPQUFPLEtBQUssRUFBRTtZQUNkLFlBQVksSUFBSSxDQUFDLE1BQU0sWUFBWSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQztTQUNoRTtRQUNELFlBQVksSUFBSSxDQUFDLE1BQU0sWUFBWSxDQUFDLEtBQUssRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDO0tBQ3pEO0FBQ0gsQ0FBQztBQW5DRCwrQkFtQ0MiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBiYXRjaEV4ZWN1dGU8VCA9IGFueT4oe1xuICBvbkVhY2hCYXRjaCxcbiAgb25CZWZvcmVCYXRjaCxcbiAgb25BZnRlckJhdGNoLFxuICBvbkJhdGNoU3VjY2VzcyxcbiAgb25CYXRjaEVycm9yLFxuICBiYXRjaFNpemUsXG4gIGRhdGEsXG59OiB7XG4gIG9uRWFjaEJhdGNoOiAoYmF0Y2g6IFRbXSwgYmF0Y2hJbmRleDogbnVtYmVyKSA9PiBQcm9taXNlPHZvaWQ+O1xuICBvbkJlZm9yZUJhdGNoPzogKGJhdGNoOiBUW10sIGJhdGNoSW5kZXg6IG51bWJlcikgPT4gUHJvbWlzZTx2b2lkPjtcbiAgb25BZnRlckJhdGNoPzogKGJhdGNoOiBUW10sIGJhdGNoSW5kZXg6IG51bWJlcikgPT4gUHJvbWlzZTx2b2lkPjtcbiAgb25CYXRjaFN1Y2Nlc3M/OiAoYmF0Y2g6IFRbXSwgYmF0Y2hJbmRleDogbnVtYmVyKSA9PiBQcm9taXNlPHZvaWQ+O1xuICBvbkJhdGNoRXJyb3I/OiAoZXJyb3I6IGFueSwgYmF0Y2g6IFRbXSwgYmF0Y2hJbmRleDogbnVtYmVyKSA9PiBQcm9taXNlPHZvaWQ+O1xuICBiYXRjaFNpemU6IG51bWJlcjtcbiAgZGF0YTogVFtdO1xufSkge1xuICBjb25zdCBkYXRhU2l6ZSA9IGRhdGEubGVuZ3RoO1xuICBsZXQgY3Vyc29yID0gMDtcblxuICAvLyBJbmNsdWRlIHRoZSBsYXN0IGJhdGNoIGV2ZW4gaWYgaXQncyBzbWFsbGVyIHRoYW4gdGhlIGJhdGNoIHNpemVcbiAgd2hpbGUgKGN1cnNvciA8IGRhdGFTaXplKSB7XG4gICAgY29uc3QgYmF0Y2ggPSBkYXRhLnNsaWNlKGN1cnNvciwgY3Vyc29yICsgYmF0Y2hTaXplKTtcbiAgICBjb25zdCBiYXRjaEluZGV4ID0gY3Vyc29yIC8gYmF0Y2hTaXplO1xuICAgIGN1cnNvciArPSBiYXRjaFNpemU7XG5cbiAgICBvbkJlZm9yZUJhdGNoICYmIChhd2FpdCBvbkJlZm9yZUJhdGNoKGJhdGNoLCBiYXRjaEluZGV4KSk7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IG9uRWFjaEJhdGNoKGJhdGNoLCBiYXRjaEluZGV4KTtcbiAgICAgIG9uQmF0Y2hTdWNjZXNzICYmIChhd2FpdCBvbkJhdGNoU3VjY2VzcyhiYXRjaCwgYmF0Y2hJbmRleCkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBvbkJhdGNoRXJyb3IgJiYgKGF3YWl0IG9uQmF0Y2hFcnJvcihlcnJvciwgYmF0Y2gsIGJhdGNoSW5kZXgpKTtcbiAgICB9XG4gICAgb25BZnRlckJhdGNoICYmIChhd2FpdCBvbkFmdGVyQmF0Y2goYmF0Y2gsIGJhdGNoSW5kZXgpKTtcbiAgfVxufVxuIl19